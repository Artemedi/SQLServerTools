# Обслуживание

Информация об различных аспектах обслуживания SQL Server.

## Служебная база данных

В разделе [Service-Database](Service-Database) содержится описание служебной базы данных для обслуживания и мониторинга, а также примеры работы с этой базой:

* Обслуживание индексов с различными настраиваемыми параметрами.
* Обслуживание объектов статистик с гибкими настройками обслуживания.
* Сбор информации о размерах таблиц баз данных на сервере.

Примеры помогут организовать обслуживание на любой вкус.

## Скрипты

| Имя скрипта | Описание |
| ----------- | -------- |
| Обслуживание индексов (простой).sql | Обслуживание индексов самым простым способом |
| Обслуживание индексов (расширенный).sql | Обслуживание индексов с расширенным набором параметров (разрешенное время выполнения, параллелизм и др.) |
| Обслуживание индексов (расширенный, online-перестроение).sql | Обслуживание индексов с рассширенным набором параметров, а также возможностью запуска online-перестроения |
| Обслуживание статистики (простой).sql | Обслуживание объектов статистики самым простым способом |
| Обслуживание статистики (расширенный).sql | Обслуживание статистики с расширенным набором параметров (разрешенное время выполнения и др.) с самым точным результатом |
| Обслуживание статистики (расширенный с автоподбором параметров).sql | Обслуживание статистики с расширенным набором параметров и гибким подбором настроек обновления (менее точная статистика, но подходит для большинства случаев) |
| Очистка процедурного кэша.sql | Очистка процедурного кэша. Будьте осторожны. Делать нужно, если понимаете зачем |
| Информация о сжатых таблицах и индексах.sql | Получение общей информации о применении сжатия к объектам базы данных |
| Сжатие таблиц базы данных.sql | Применение сжатия для всех таблиц и индекосв в базе данных (по умолчанию - PAGE) |
| Обслуживание индексов для всех баз данных (пример).sql | Пример скрипта для запуска обслуживания индексов для всех баз данных |
| Обслуживание статистик для всех баз данных (пример).sql | Пример скрипта для запуска обслуживания статистик для всех баз данных |

## Материалы

* [UPDATE STATISTICS (Transact-SQL)](https://docs.microsoft.com/ru-ru/sql/t-sql/statements/update-statistics-transact-sql?view=sql-server-ver15) - информация о командах обновления статистики.
* [ALTER INDEX (rebuild, reorganize etc)](https://docs.microsoft.com/ru-ru/sql/t-sql/statements/alter-index-transact-sql?view=sql-server-ver15) - информация о командах изменения индексов.
* [NORECOMPUTE option of UPDATE STATISTICS in SQL Server](https://www.mssqltips.com/sqlservertip/1056/norecompute-option-of-update-statistics-in-sql-server/) - полезная информация об опции NORECOMPUTE.
* [sp_updatestats overview and usage](https://www.sqlshack.com/sp_updatestats-overview-and-usage/) - информация о хранимой процедуре sp_updatestats, поставляемой по умолчанию с СУБД.
* [UPDATE STATISTICS: the Secret IO Explosion](https://www.brentozar.com/archive/2014/01/update-statistics-the-secret-io-explosion/) - почему обновление статистики может привести к проблемам с операциями ввода-вывода.
* [SQL Server Index and Statistics Maintenance](https://ola.hallengren.com/sql-server-index-and-statistics-maintenance.html) - пример решения для обслуживания индексов и статистик.
